const __modules = globalThis.__coffeebreak_modules;
const __require = (id) => { const m = __modules?.[id]; if (!m) throw new Error(`Module "${id}" not found in host.`); return m; };
var w=Object.create;var _=Object.defineProperty;var k=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var S=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty;var b=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports);var B=(e,r,i,a)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of E(r))!C.call(e,s)&&s!==i&&_(e,s,{get:()=>r[s],enumerable:!(a=k(r,s))||a.enumerable});return e};var p=(e,r,i)=>(i=e!=null?w(S(e)):{},B(r||!e||!e.__esModule?_(i,"default",{value:e,enumerable:!0}):i,e));var A=b((M,d)=>{d.exports=__require("react")});var g=b((H,m)=>{m.exports=__require("react/jsx-runtime")});var c=p(A());function y(e){return(globalThis.__coffeebreak_event_app_registry||{})[e]}function v(){let e=y("getApi");if(!e)throw new Error('CoffeeBreak SDK: "getApi" was not registered. Call registerEventAppApi({ getApi }) in event-app/src/main.jsx.');return e()}function l(e){return function(){let r=y(e);if(!r)throw new Error(`CoffeeBreak SDK: "${e}" was not registered. Call registerEventAppContexts({ ${e} }) in event-app/src/main.jsx.`);return r()}}var U=l("useMedia"),x=l("useWebSocket"),K=l("useActivity");var n=p(g());function T(){let[e,r]=(0,c.useState)([]),{subscribe:i,unsubscribe:a,addMessageHandler:s,removeMessageHandler:f,isConnected:u}=x(),h=o=>{r(t=>[o.data,...t].slice(0,3))};return(0,c.useEffect)(()=>{let o=async()=>{try{let{data:t}=await v().get("/alert-system-plugin/alert/high-priority/");r(t)}catch(t){console.error("Error fetching alerts:",t.response?.data||t.message)}};return u&&(console.log("Subscribing to high-priority-alerts"),i("high-priority-alerts").then(()=>{console.log("Successfully subscribed to high-priority-alerts"),s("high-priority-alerts",h),o()}).catch(t=>{console.error("Failed to subscribe to high-priority-alerts:",t)})),()=>{console.log("Unsubscribing from high-priority-alerts"),f("high-priority-alerts",h),a("high-priority-alerts").then(()=>{console.log("Successfully unsubscribed from high-priority-alerts")}).catch(t=>{console.error("Failed to unsubscribe from high-priority-alerts:",t)})}},[u,i,a,s,f]),e.length===0?null:(0,n.jsx)("div",{className:"flex flex-col w-15/16 mx-auto gap-3 my-4",children:e.map(o=>(0,n.jsxs)("div",{className:"px-4 py-1 bg-warning text-warning-content rounded-xl",children:[(0,n.jsx)("div",{className:"font-medium",children:o.message}),(0,n.jsx)("div",{className:"text-xs opacity-75",children:new Date(o.created_at).toLocaleTimeString()})]},o.id))})}var F=T;export{F as default};
